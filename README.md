# 在线试卷编辑系统

本系统是桂电毕业设计的一部分，用于实现在线试卷的编辑、预览和批阅功能。

## 系统功能

### 试卷编辑功能
- **试卷基本信息管理**：设置试卷标题、科目、考试时长、总分和用途
- **多种题型支持**：单选题、多选题、填空题、客观题和题注
- **题注功能**：支持添加阅读材料等共享内容，且不计入题目编号
- **拖拽排序**：可通过拖拽调整试题顺序
- **富文本编辑**：支持文本格式化、图片、表格、数学公式等
- **预览功能**：实时预览试卷效果
- **打印功能**：支持导出打印格式的试卷

### 试卷管理功能
- **试卷保存**：将编辑的试卷保存到系统中
- **试卷导入**：可导入已有试卷进行编辑
- **OCR识别**：支持通过OCR技术从图片中导入试卷内容

### 管理员系统
- **管理员登录**：独立的管理员登录界面
- **控制面板**：显示系统概览数据和统计图表
- **用户管理**：管理系统用户、角色和权限
  - 支持管理员、教师、学生三种角色用户
  - 批量导入/导出用户数据
  - 用户信息查询、新增、编辑、删除
  - 用户状态管理和密码重置
- **教育资源管理**：管理学院、班级、教师和学生信息
- **系统设置**：配置系统参数、备份数据和查看日志

### 课程管理

课程管理模块提供了对课程的CRUD操作功能，包括：

1. **课程列表**：分页展示课程信息，支持按课程名称、学时、学分、状态等条件筛选
2. **课程创建**：创建新课程，设置课程名称、学时、学分、课程容量、上课时间、授课教师等信息
3. **课程编辑**：修改现有课程信息
4. **课程状态管理**：支持课程开课/结课状态切换
5. **批量操作**：支持批量删除、批量开课、批量结课等操作

#### 课程数据结构

```typescript
interface Course {
  id: number;              // 课程ID
  lessonName: string;      // 课程名称  
  hours: string;           // 学时
  score: string;           // 学分
  classTime: string;       // 上课时间
  introduction: string;    // 课程介绍
  teacherName?: string;    // 教师名称
  teacherId?: number;      // 教师ID
  capacity: number;        // 课程容量
  status: number;          // 课程状态(0:已结课, 1:未结课)
  createTime?: string;     // 创建时间
  updateTime?: string;     // 更新时间
  // 课程关联的教师信息
  name?: string;           // 教师姓名
  phone?: string;          // 联系电话
  email?: string;          // 邮箱
  sex?: number;            // 性别
  avatar?: string;         // 头像
  description?: string;    // 个人简介
}
```

#### API接口

课程管理模块的主要API接口有：

- 课程列表查询：`POST /system/lesson/list`
- 课程详情获取：`GET /system/lesson/detail/{id}`
- 创建课程：`POST /system/lesson/create`
- 更新课程：`PUT /system/lesson/update`
- 删除课程：`DELETE /system/lesson/delete/{id}`
- 批量删除：`DELETE /system/lesson/batch/delete`
- 开课/结课：`PUT /system/lesson/enable/{id}` / `PUT /system/lesson/disable/{id}`
- 批量开课/结课：`PUT /system/lesson/batch/enable` / `PUT /system/lesson/batch/disable`

## 技术栈
- **前端框架**：Vue 3 + TypeScript + Vite
- **UI组件**：Element Plus
- **状态管理**：Pinia
- **路由管理**：Vue Router
- **HTTP客户端**：Axios
- **CSS预处理器**：SCSS/CSS
- **富文本编辑器**：Quill
- **拖拽功能**：vuedraggable
- **数据可视化**：ECharts

## 使用指南

### 1. 试卷编辑
1. 设置试卷基本信息（标题、科目、时长、总分等）
2. 点击"添加试题"或"添加题注"按钮添加内容
3. 编辑每个试题的内容、选项、答案和解析
4. 使用排序功能调整题目顺序
5. 点击"保存试卷"将试卷保存到系统中

### 2. 题注功能
1. 点击"添加题注"按钮添加阅读材料等共享内容
2. 设置题注标题和内容
3. 题注不会计入题目编号，方便组织阅读理解等题型

### 3. 拖拽排序
1. 点击"排序题目"按钮进入排序模式
2. 拖拽题目卡片调整顺序
3. 点击"保存排序"确认新的排序
4. 系统会自动重新编号题目ID，确保答案引用正确更新

### 4. 试卷导入
1. 点击"已有试卷"按钮
2. 选择学院和科目
3. 从列表中选择要导入的试卷
4. 点击"导入试卷"按钮将试卷内容导入编辑器

### 5. 管理员系统
1. 访问 `/admin/login` 进入管理员登录页面
2. 使用管理员账号登录系统
3. 在控制面板查看系统概览数据
4. 通过左侧导航栏访问各项管理功能

### 6. 用户管理功能
1. **用户列表页面**
   - 在管理员系统中点击左侧导航栏的"用户管理"
   - 可通过用户名、姓名、角色和状态筛选用户
   - 表格中显示用户基本信息和状态
   - 支持分页浏览大量用户数据

2. **用户操作**
   - **查看详情**：点击"详情"按钮查看用户完整信息
   - **编辑用户**：点击"编辑"按钮修改用户信息
   - **启用/禁用**：控制用户账号状态
   - **重置密码**：为用户重置登录密码
   - **删除用户**：从系统中删除用户账号

3. **批量操作**
   - 选择多个用户后可进行批量启用/禁用/删除操作
   - 支持导入/导出用户数据，便于批量管理

4. **用户新增**
   - 点击"新增用户"按钮创建新用户
   - 根据角色不同展示不同的表单字段
   - 管理员角色：填写基本信息
   - 教师角色：填写基本信息、学院、职称、学历等
   - 学生角色：填写基本信息、学院、专业、班级、年级等

## 注意事项
1. 编辑试题时请注意区分答案和解析内容
2. 题目排序后会重新编号，系统会自动处理答案引用更新
3. 导入试卷后请检查格式是否正确
4. 试卷保存前请确保所有必要信息已填写完整
5. 管理员系统的访问端口为8989，与学生/教师系统的39999端口不同

## 最近优化内容

### 2025年更新

1. **管理员系统**
   - 新增独立的管理员登录和管理界面
   - 使用响应式设计，支持在各种设备上访问
   - 提供系统数据可视化展示
   - 集中化管理用户、课程和教育资源

2. **题目ID生成逻辑优化**
   - 修改为按顺序编号（1,2,3...）而非随机数
   - 确保ID连续性，便于管理和查找

3. **题注功能增强**
   - 新增题注类型，用于设置阅读理解等题目的共享材料
   - 题注不计入题目编号，解决了阅读理解题目编号混乱问题

4. **拖拽排序功能**
   - 实现通过vuedraggable库的拖拽排序功能
   - 允许用户直观地调整题目顺序
   - 优化排序后重新编号逻辑，确保所有引用正确更新

5. **富文本格式显示优化**
   - 修复富文本编辑器格式在预览区域的显示问题
   - 增强CSS样式支持，确保格式在不同环境下一致显示

6. **多选题功能**
   - 支持多个正确答案的选择
   - 优化多选题答案存储逻辑，确保数据格式一致性

7. **导入试卷功能优化**
   - 修复导入试卷后对话框无法关闭的问题
   - 添加加载状态提示，提升用户体验
   - 增强错误处理，提供更友好的错误提示
   - 优化数据导入流程，减少不必要的网络请求

8. **类型安全增强**
   - 修复各种题型的TypeScript类型定义
   - 增强数据转换和处理的类型安全性

9. **用户管理功能增强**
   - 新增用户管理模块，支持多角色用户管理
   - 实现用户批量导入/导出功能
   - 优化表格性能，支持虚拟滚动和列宽调整
   - 实现批量启用/禁用用户功能
   - 加强表单验证规则，提高数据质量
   - 优化用户详情页面，集中展示用户信息和登录记录
   - 移除模拟数据，实现与后端API的无缝集成
   - 优化数据映射逻辑，确保表单数据与API格式一致

## 安装和使用

```bash
# 安装依赖
npm install

# 开发模式启动
npm run dev

# 构建生产版本
npm run build
```

## 项目结构

```
src/
├── api/            # API接口定义
├── assets/         # 静态资源
├── components/     # 公共组件
├── router/         # 路由配置
├── stores/         # Pinia状态管理
├── styles/         # 全局样式
├── utils/          # 工具函数
├── views/          # 页面组件
│   ├── admin/      # 管理员相关页面
│   └── ...
└── App.vue         # 根组件
```
